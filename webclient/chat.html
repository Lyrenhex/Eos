<!--
COPYRIGHT (C) Damian Heaton 2017 - 2018

The storage of this software on a computer via means of browser 'caching', and the execution of such code by user browsers is permitted. This work cannot be duplicated, copied, distributed, or modified (neither privately nor publicly) without the express, written consent of Damian Heaton, whom can be contacted (at time of notice) at damian@lyrenhex.me. This software cannot be used for commercial purposes.

THIS SOFTWARE IS DISTRIBUTED "AS IS", WITHOUT WARRANTY OF ANY FORM (EITHER EXPRESS OR IMPLIED), INCLUDING (BUT NOT LIMITED TO) ANY IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.

TL;DR:
You may:
- Store this software on a computer via a browser's cache, though not by any other means.
- Store this software for purposes of search indexing.
- Execute this code for the purpose of using the software.

You may NOT:
- Distribute, copy, replicate, or duplicate this copyrighted software without express, written permission from Damian Heaton.
- Use this software, in any way, shape or form, for any commercial purpose(s).
- Claim this software as your own, or attempt to imply affiliation with the software in any way that could be detrimental or unlawful, or to suggest that the software, or Damian Heaton, are represented by, or represent, yourself.
-->

<!doctype html>
<html lang="en-UK">
  <head>
    <title>Eos App: Chat</title> <!-- set this to a generic name; we can change it based on user state and actions. -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta name="robots" content="noindex, nofollow" />
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="logo.png" />

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.1/firebase-database.js"></script>

    <style>
      body {
        background-color: #eee;
        font-family: 'Roboto', sans-serif;
      }

      .loading {
        font-size: 24pt;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #00c0ff;
        transition: 1s ease-in all;
      }
    </style>
  </head>

  <body>
    <span class="loading" id="text__loading">Getting ready!</span>

    <div class="chat" id="block__chat">
      <input type="text" id="cb" placeholder="Say something! (Press the enter key to send.)" />
    </div>

    <button class="tracker" id="button__report" onclick="show('block__report')">I'm uncomfortable</button>

    <div class="block" id="block__held">
      <h2>Woah, you sure that's cool?</h2>
      <p>Our systems detected that your recent message, shown below, seemed a bit off-kilter. Are you <b>sure</b> that you want to send this?</p>
      <p>If you're confused by this message, and feel that your message carries the best intentions, then please feel free to disregard this; after all, AI isn't perfect!</p>
      <p>If, however, you feel this message could be seen as cold, cruel, or callous, perhaps it would be best to rethink it. It's important to appreciate that, even if you're happy or in a dip, the other person you're speaking to can also be feeling horrific; cruelty in this instance can have <i>catastrophic consequences</i>, and we don't want you to feel guilty should they do anything drastic.</p>
      <p>You said:</p>
      <blockquote><span name="heldmsg"></span></blockquote>
      <button id="heldmsg_accept">I'm sure about this, send it! :)</button>
      <button onclick="done('block__held')" id="heldmsg_reject">Cancel sending</button>
    </div>

    <div class="block" id="block__closed">
      <h2>Connection lost</h2>
      <p>Huh, it appears that we've lost connection to the chat server. This isn't necessarily unexpected, as there are several things that can cause this:</p>
      <ul>
        <li>The server's crashed.</li>
        <li>Your internet connection is gone; can you still browse?</li>
        <li><b>Most likely:</b> The person who you were talking to disconnected, which causes the server to terminate the chat session entirely.</li>
      </ul>
      <p>If your internet connection is good to go, and you wanna chat with someone still, feel free to simply refresh this page. We'll reconnect you to the server and get you into a new chat.</p>
      <p><small>The other user is removed from the server if a chat participant leaves in order to increase chances (almost guaranteeing) that those two people will not knowingly speak to each other again, as if we simply put you in the waiting list, if the leaver then rejoined they may be put into the same chat as before.</small></p>
    </div>

    <div class="block" id="block__error">
      <h2>Oh, bugger!</h2>
      <p>Unfortunately, it appears that we've hit quite the snag. If you feel like it, could you be so kind as to email <a href="mailto:dh64784@gmail.com">dh64784@gmail.com</a> with some information about what happened (what you were doing to cause this message to appear) and the error dump displayed below?</p>
      <p>Please be sure to check back later to see if it's fixed! :&gt;</p>
      <pre id="error_dump"></pre>
    </div>
    <div class="block" id="block__loggedout">
      <h2>Wait, who are you?</h2>
      <p>You appear not to be signed in to Eos, and we sort of need users to be signed in. Usually, that's done <a href="app.html">here</a>. Go through the login process, and we'll see you here again shortly!</p>
      <a class="btn" href="app.html">Log in</a>
    </div>

    <div class="block" id="block__report">
      <h2>We want to look into this. Can we?</h2>
      <p>Your mental health is our priority, and we want to be able to do everything within our power to help prevent abuse of any of our users -- including you.</p>
      <p>We would like to look into this matter further, to attempt to identify any harmful language which may have been used by the other party during this conversation and handle the situation appropriately. The other party's personally identifying information, or your own, will not be disclosed to any individual, unless required as per UK law enforcement.</p>
      <p>Due to our confidentiality agreement within our terms of service, we require your consent to sending a log of this chat. If you would like us to look into this and help prevent further issues, please press the button below.</p>
      <p>If you object to us looking into this, you may simply terminate the chat session. This will erase any logs currently stored in volatile memory, and cannot be recovered.</p>
      <button id="btnReport">Look into this for me, please.</button>
      <button id="btnExit">End chat.</button>
    </div>
    <div class="block" id="block__unverified">
      <h2>Unverified email address</h2>
      <p>Whoops! It appears that you're using an email address that hasn't been verified. In order to protect both yourself and other users, we require participants using the chat functionality of Eos to have a verified email address. Please check your email (including spam / junk folders) for a verification email from us, then reload this page.</p>
      <button id="btnResendVerification">Resend verification email.</button>
    </div>
    <div class="block" id="block__loggedout">
      <h2>Wait, who are you?</h2>
      <p>You appear not to be signed in to Eos, and we sort of need users to be signed in. Usually, that's done <a href="app.html">here</a>. Go through the login process, and we'll see you here again shortly!</p>
      <a class="btn" href="app.html">Log in</a>
    </div>

    <link rel="stylesheet" href="app.css" />
    <script src="func.js"></script>
    <script src="chat.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Spectral" />
    </body>
    </html>
